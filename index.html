<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
    <title>WebAR MVP Test</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r17/Stats.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        
        a-scene {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
        }
        
        .instructions {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 15px;
            z-index: 2;
            border-top: 2px solid #4285F4;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        
        .markers {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .marker-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .markers img {
            width: 100px;
            height: 100px;
            border: 2px solid #4285F4;
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
            margin-bottom: 8px;
        }
        
        .marker-label {
            font-weight: bold;
            color: #4285F4;
        }
        
        #stats {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
        }
        
        .status {
            margin-top: 10px;
            padding: 8px;
            background: #e8f0fe;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>
<body>
    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false;"
        renderer="logarithmicDepthBuffer: true;"
    >
        <!-- Маркер HIRO: Цилиндр -->
        <a-marker preset="hiro">
            <a-cylinder 
                color="#FF5733" 
                radius="0.5" 
                height="1" 
                position="0 0.5 0"
                rotation="0 180 0"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 3000">
            </a-cylinder>
        </a-marker>
        
        <!-- Маркер KANJI: Куб -->
        <a-marker preset="kanji">
            <a-box 
                color="#4CC3D9" 
                position="0 0.5 0" 
                scale="0.5 0.5 0.5"
                animation="property: position; to: 0 1 0; dir: alternate; loop: true; dur: 2000">
            </a-box>
        </a-marker>
        
        <a-camera></a-camera>
    </a-scene>
    
    <div class="instructions">
        <h2>WebAR Технологический MVP</h2>
        <p>Наведите камеру на один из маркеров:</p>
        
        <div class="markers">
            <div class="marker-item">
                <img src="https://raw.githubusercontent.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/trex-image/trex-image-big.jpeg" 
                     alt="HIRO маркер">
                <span class="marker-label">HIRO маркер</span>
                <p>3D-цилиндр с анимацией</p>
            </div>
            
            <div class="marker-item">
                <img src="https://raw.githubusercontent.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/kanji/kanji.png" 
                     alt="KANJI маркер">
                <span class="marker-label">KANJI маркер</span>
                <p>Анимированный куб</p>
            </div>
        </div>
        
        <div class="status" id="status">
            AR инициализирован. Наведите камеру на маркер...
        </div>
        
        <p><small>Используйте эти маркеры с экрана другого устройства или распечатайте</small></p>
    </div>
    
    <div id="stats"></div>

    <script>
        // Инициализация статистики
        const stats = new Stats();
        stats.showPanel(0);
        document.getElementById('stats').appendChild(stats.dom);
        
        // Обновление статистики
        const scene = document.querySelector('a-scene');
        scene.addEventListener('renderstart', () => {
            document.getElementById('status').style.display = 'block';
            requestAnimationFrame(function updateStats() {
                stats.update();
                requestAnimationFrame(updateStats);
            });
        });
        
        // Логирование событий
        document.querySelector('a-marker[preset="hiro"]').addEventListener('markerFound', () => {
            console.log('Маркер HIRO обнаружен');
        });
        
        document.querySelector('a-marker[preset="kanji"]').addEventListener('markerFound', () => {
            console.log('Маркер KANJI обнаружен');
        });
    </script>
</body>
</html>
